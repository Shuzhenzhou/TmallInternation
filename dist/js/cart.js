"use strict";$(function(){function s(){var t=0;$(".cartBox input:checked").siblings(".jieshao").find(".perTotle").find("em").each(function(){t+=parseInt($(this).html())}),$("#totalPrice span").html(t)}console.log($("#totalPrice span")),$.get("http://47.104.244.134:8080/cartlist.do",{token:$.cookie("token")},function(t){for(var i="",n=0;n<t.length;n++)i+='<li>\n\t\t\t\t\t<input type="checkbox">\n\t\t\t\t\t<div class="cartImg">\n\t\t\t\t\t\t<img src="'+t[n].goods.picurl+'"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="jieshao">\n\t\t\t\t\t\t<p>'+t[n].goods.name+'</p>\n\t\t\t\t\t\t<span class="danjia"><i>单价:</i><em>'+t[n].goods.price+'</em></span>\n\t\t\t\t\t\t<span class="perTotle"><i>总价:</i><em>'+t[n].count*t[n].goods.price+'</em></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="shuliang">\n\t\t\t\t\t\t<p>数量：&nbsp;&nbsp;&nbsp;<i>'+t[n].count+'</i></p>\n\t\t\t\t\t\t<button class="add" data-id="'+t[n].id+'" data-gid="'+t[n].gid+'">+</button>\n\t\t\t\t\t\t<button class="minus" data-id="'+t[n].id+'" data-gid="'+t[n].gid+'">-</button>\n\t\t\t\t\t\t<button class = "delete" data-id="'+t[n].id+'" data-gid="'+t[n].gid+'">删除商品</button>\n\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t</li>';$(".cartBox ul").html(i),$(".cartBox input").prop("checked",!0),s();for(var a=0;a<$(".cartBox li").length;a++)$(".cartBox li").eq(a).find(".add").click(function(){var a=$(this),t=$(this).attr("data-id"),i=$(this).attr("data-gid"),n=$.cookie("token");$.get("http://47.104.244.134:8080/cartupdate.do",{id:t,gid:i,num:1,token:n},function(t){if(0==t.code){var i=$(a).siblings("p").find("i").html();$(a).siblings("p").find("i").html(++i);var n=$(a).parent().siblings(".jieshao").find(".danjia").find("em").html()*i;$(a).parent().siblings(".jieshao").find(".perTotle").find("em").html(n)}s()})}),$(".cartBox li").eq(a).find(".minus").click(function(){var a=$(this),d=$(this).attr("data-id"),e=$(this).attr("data-gid"),o=$.cookie("token");$.get("http://47.104.244.134:8080/cartupdate.do",{id:d,gid:e,num:-1,token:o},function(t){if(0==t.code){var i=$(a).siblings("p").find("i").html();$(a).siblings("p").find("i").html(--i);var n=$(a).parent().siblings(".jieshao").find(".danjia").find("em").html()*i;$(a).parent().siblings(".jieshao").find(".perTotle").find("em").html(n),0==i&&($(a).parent().parent().remove(),$.get("http://47.104.244.134:8080/cartupdate.do",{id:d,gid:e,num:0,token:o},function(t){}))}s()})}),$(".cartBox li").eq(a).find(".delete").click(function(){var i=$(this),t=$(this).attr("data-id"),n=$(this).attr("data-gid"),a=$.cookie("token");$.get("http://47.104.244.134:8080/cartupdate.do",{id:t,gid:n,num:0,token:a},function(t){0==t.code&&$(i).parent().parent().remove(),s()})}),$(".cartBox input").click(function(){s()})})});